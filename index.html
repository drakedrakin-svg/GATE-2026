<!doctype html>
<html lang="pt-br">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Prova GATE</title>

<style>
:root{
  --bg:#0b0f14;
  --card:#121a24;
  --border:#223047;
  --input:#0e141d;
  --blue:#2b6fff;
  --ok:#7CFFB2;
  --err:#FF7C7C;
}
*{box-sizing:border-box}
body{
  margin:0;
  padding:24px;
  font-family:Segoe UI,Arial,sans-serif;
  background:var(--bg);
  color:#eaf0ff;
}
.card{
  max-width:850px;
  margin:auto;
  background:var(--card);
  border:1px solid var(--border);
  border-radius:18px;
  padding:24px;
}
h1{text-align:center;margin-top:0}
.timer{
  text-align:center;
  font-size:18px;
  margin-bottom:20px;
  color:#ffcc66;
}
label{display:block;margin-top:16px}
input{
  width:100%;
  padding:10px;
  border-radius:12px;
  border:1px solid var(--border);
  background:var(--input);
  color:#fff;
}
.question{
  margin-top:24px;
  padding:16px;
  border:1px solid var(--border);
  border-radius:12px;
}
.question p{margin:0 0 10px}
button{
  width:100%;
  margin-top:24px;
  padding:14px;
  border:none;
  border-radius:14px;
  background:var(--blue);
  color:#fff;
  font-size:16px;
  font-weight:700;
  cursor:pointer;
}
#msg{text-align:center;margin-top:16px}
.ok{color:var(--ok)}
.err{color:var(--err)}
</style>
</head>

<body>
<div class="card">
<h1>ğŸ“‘ PROVA GATE</h1>

<div class="timer">
â±ï¸ Tempo restante: <span id="time">20:00</span>
</div>

<label>ID do Discord (obrigatÃ³rio)</label>
<input id="discord" placeholder="Ex: 123456789012345678">

<form id="prova"></form>

<button onclick="enviar()">Enviar Prova</button>
<div id="msg"></div>
</div>

<script>
// ğŸ”’ BLOQUEIO DE SEGUNDA TENTATIVA
if(localStorage.getItem("gate_prova_finalizada")){
  document.body.innerHTML =
    "<h2 style='text-align:center;color:#ff7c7c;margin-top:80px'>âŒ VocÃª jÃ¡ realizou esta prova.</h2>";
  throw new Error("Prova jÃ¡ realizada");
}

// âš ï¸ AVISO AO SAIR
window.onbeforeunload = () => "Ao sair, sua prova serÃ¡ perdida.";

const TEMPO_TOTAL = 20 * 60;
let tempo = TEMPO_TOTAL;
let intervalo;

const webhook = "https://discord.com/api/webhooks/1461806116987212071/LF2QtlSC7wpwHHiMPZsGWgn9orRG4BCjS2r5GRa0f3GRAndohmirBYnC-QTvPddDum8q";

// GABARITO
const questoes = [
["A prÃ¡tica de corrupÃ§Ã£o Ã©:", "Extremamente inadmissÃ­vel", "Permitida", "Opcional", "AceitÃ¡vel", 0],
["O policial deve obedecer:", "A hierarquia", "Somente civis", "A imprensa", "Qualquer pessoa", 0],
["O CPPM regula:", "Conduta militar", "Somente crimes civis", "Apenas trÃ¢nsito", "Economia", 0],
["Ordem ilegal deve ser:", "Questionada", "Cumprida", "Ignorada", "Divulgada", 0],
["InfraÃ§Ã£o leve gera:", "Multa", "PrisÃ£o", "ExoneraÃ§Ã£o", "Nada", 0],
["O policial pode se omitir?", "Nunca", "Sempre", "Ã€s vezes", "Se quiser", 0],
["Uso da forÃ§a deve ser:", "Proporcional", "Excessivo", "Livre", "Irrestrito", 0],
["Hierarquia garante:", "Disciplina", "Desordem", "Caos", "Impunidade", 0],
["Quem viola o CPPM sofre:", "PuniÃ§Ã£o", "PromoÃ§Ã£o", "BenefÃ­cio", "Nada", 0],
["Lealdade institucional Ã©:", "ObrigatÃ³ria", "Opcional", "TemporÃ¡ria", "Irrelevante", 0],
["TransgressÃ£o Ã©:", "InfraÃ§Ã£o disciplinar", "Elogio", "Medalha", "PromoÃ§Ã£o", 0],
["O policial deve proteger:", "A vida", "Somente bens", "A si mesmo", "A corporaÃ§Ã£o apenas", 0],
["A ordem obscura deve ser:", "Esclarecida", "Cumprida sem questionar", "Ignorada", "Divulgada", 0],
["O policial responde por omissÃ£o?", "Sim", "NÃ£o", "Nunca", "Somente civil", 0],
["Hierarquia serve para:", "OrganizaÃ§Ã£o", "Abuso", "Favorecimento", "ConfusÃ£o", 0],
["Conduta Ã©tica Ã©:", "ObrigatÃ³ria", "Opcional", "Rara", "PunÃ­vel", 0],
["Disciplina Ã© base da:", "InstituiÃ§Ã£o", "Anarquia", "Desordem", "Fraude", 0],
["Quem desrespeita regras:", "Ã‰ punido", "Ã‰ premiado", "Nada sofre", "Ã‰ promovido", 0],
["A autoridade vem da:", "FunÃ§Ã£o", "ForÃ§a fÃ­sica", "AmeaÃ§a", "Arma", 0],
["O policial deve agir com:", "Imparcialidade", "Favorecimento", "Interesse prÃ³prio", "Vantagem", 0]
];

// MONTAR PROVA
const form = document.getElementById("prova");
questoes.forEach((q,i)=>{
  const div = document.createElement("div");
  div.className = "question";
  div.innerHTML =
    `<p><strong>${i+1}.</strong> ${q[0]}</p>` +
    q.slice(1,5).map((alt,j)=>
      `<label><input type="radio" name="q${i}" value="${j}"> ${alt}</label>`
    ).join("");
  form.appendChild(div);
});

// TIMER
intervalo = setInterval(()=>{
  tempo--;
  const m = String(Math.floor(tempo/60)).padStart(2,"0");
  const s = String(tempo%60).padStart(2,"0");
  document.getElementById("time").textContent = `${m}:${s}`;
  if(tempo<=0){
    clearInterval(intervalo);
    enviar();
  }
},1000);

// ENVIO
function enviar(){
  clearInterval(intervalo);
  window.onbeforeunload = null;

  const discord = document.getElementById("discord").value.trim();
  if(discord.length < 17){
    alert("ID do Discord obrigatÃ³rio.");
    return;
  }

  let acertos = 0;
  questoes.forEach((q,i)=>{
    const r = document.querySelector(`input[name=q${i}]:checked`);
    if(r && Number(r.value) === q[5]) acertos++;
  });

  const status = acertos >= 15 ? "APROVADO âœ…" : "REPROVADO âŒ";
  const data = new Date().toLocaleString("pt-BR");

  fetch(webhook,{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({
      content:
`ğŸ“Š **RESULTADO â€“ PROVA GATE**
ğŸ‘¤ <@${discord}>
ğŸ“ Nota: ${acertos}/20
ğŸ“Œ Status: ${status}
ğŸ•’ Data: ${data}
ğŸ’» Navegador: ${navigator.userAgent}`
    })
  });

  localStorage.setItem("gate_prova_finalizada","true");

  document.getElementById("msg").innerHTML =
    `<p class="${acertos>=15?'ok':'err'}">Prova finalizada. Resultado enviado Ã  coordenaÃ§Ã£o.</p>`;
}
</script>
</body>
</html>
